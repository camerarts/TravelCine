import { PosterFormData } from "./types";

// Helper to format YYYY-MM-DD to YYYY.MM.DD
const formatDateFull = (dateStr: string): string => {
  if (!dateStr) return "";
  return dateStr.replace(/-/g, '.');
};

// Helper to format YYYY-MM-DD to MM.DD
const formatDateShort = (dateStr: string): string => {
  if (!dateStr) return "";
  // Check if standard ISO format YYYY-MM-DD
  if (dateStr.length >= 10) {
    return dateStr.substring(5).replace(/-/g, '.');
  }
  return dateStr;
};

export const getPromptContext = (data: PosterFormData): Record<string, string> => {
  const { title, englishTitle, locations } = data;

  // Auto-calculate start and end dates based on locations
  const sortedDates = locations
    .map(loc => loc.date)
    .filter(date => date !== "")
    .sort();

  const startDate = sortedDates.length > 0 ? sortedDates[0] : "";
  const endDate = sortedDates.length > 0 ? sortedDates[sortedDates.length - 1] : "";

  return {
    title: title,
    englishTitle: englishTitle,
    dateRange: `${formatDateFull(startDate)} - ${formatDateShort(endDate)}`,
    loc1_name: locations[0].name,
    loc1_date: formatDateShort(locations[0].date),
    loc2_name: locations[1].name,
    loc2_date: formatDateShort(locations[1].date),
    loc3_name: locations[2].name,
    loc3_date: formatDateShort(locations[2].date),
  };
};

export const fillPromptTemplate = (template: string, context: Record<string, string>): string => {
  return template.replace(/{{(\w+)}}/g, (_, key) => context[key] || `{{${key}}}`);
};

export const DEFAULT_PROMPT_TEMPLATE = `
è§’è‰²ï¼šä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„æ—…è¡Œè§†è§‰è®¾è®¡å¸ˆï¼Œæ“…é•¿å°†ç”¨æˆ·çš„æ—…è¡Œç…§ç‰‡è½¬åŒ–ä¸ºç”µå½±çº§çš„å›žå¿†æµ·æŠ¥ã€‚

ä»»åŠ¡ï¼šæ ¹æ®ä»¥ä¸‹å…·ä½“æ—…è¡Œç»†èŠ‚ç”Ÿæˆä¸€å¼  9:16 ç«–ç‰ˆæ—…è¡Œæµ·æŠ¥ï¼š
- æ ‡é¢˜ï¼š"{{title}} Â· {{englishTitle}}"
- æ—¥æœŸèŒƒå›´ï¼š"{{dateRange}}"
- åœ°ç‚¹ 1 (Pin 1)ï¼š{{loc1_name}} (æ—¥æœŸ: {{loc1_date}})
- åœ°ç‚¹ 2 (Pin 2)ï¼š{{loc2_name}} (æ—¥æœŸ: {{loc2_date}})
- åœ°ç‚¹ 3 (Pin 3)ï¼š{{loc3_name}} (æ—¥æœŸ: {{loc3_date}})

ðŸ“¸ äººç‰©ä¿çœŸæŠ€æœ¯ (HIGHEST PRIORITY):
- ä¸¥æ ¼ä¿æŒç”¨æˆ·åŽŸå›¾äººç‰©çš„é¢éƒ¨ç‰¹å¾ã€å§¿æ€ã€æœè£…ã€‚
- ç¡®ä¿åŒä¸€äººç‰©åœ¨æ‰€æœ‰ä¸‰å¼ ç…§ç‰‡ä¸­å‡ºçŽ°ã€‚
- ä»…æ›¿æ¢èƒŒæ™¯ä¸ºä¸åŒçš„æ—…è¡Œç›®çš„åœ°åœºæ™¯ã€‚
- ç¡®ä¿äººç‰©å…‰å½±ä¸Žæ–°çŽ¯å¢ƒåè°ƒç»Ÿä¸€ã€‚

è§†è§‰ç»“æž„ï¼ˆå¿…é¡»ä¸¥æ ¼éµå®ˆï¼‰ï¼š
1. é¡¶éƒ¨æ ‡é¢˜æ ï¼ˆçº¦å 8-10%é«˜åº¦ï¼‰ï¼š
   - èƒŒæ™¯å›¾ç‰‡ï¼šå¿…é¡»ä½¿ç”¨ **åœ°ç‚¹ 2 ({{loc2_name}})** çš„é£Žæ™¯å›¾ç‰‡ã€‚
   - å¤„ç†æ•ˆæžœï¼šåº”ç”¨è½»åº¦é«˜æ–¯æ¨¡ç³Šï¼ˆåŠå¾„ 8-10pxï¼‰ï¼Œä¿ç•™æ™¯ç‚¹çš„æ¸…æ™°è½®å»“å’Œç»†èŠ‚ã€‚
   - é®ç½©ï¼šå åŠ åŠé€æ˜Žæ·±è‰²æ¸å˜ï¼ˆä»Žé¡¶éƒ¨çš„ rgba(0,0,0,0.45) åˆ°åº•éƒ¨çš„ rgba(0,0,0,0.35)ï¼‰ã€‚
   
   ðŸ“ æ–‡å­—æŽ’ç‰ˆ (STRICT SINGLE LINE LAYOUT):
     * ðŸš¨ **å¼ºåˆ¶å•è¡Œæ˜¾ç¤º**ï¼šä¸­æ–‡æ ‡é¢˜ "{{title}}" å’Œ è‹±æ–‡æ ‡é¢˜ "{{englishTitle}}" å¿…é¡»æ˜¾ç¤ºåœ¨åŒä¸€è¡Œã€‚
     * è¿žæŽ¥æ–¹å¼ï¼šä½¿ç”¨ " Â· " (Middle Dot) ä½œä¸ºåˆ†éš”ç¬¦ã€‚
     * æœ€ç»ˆæ•ˆæžœç¤ºä¾‹ï¼š**{{title}} Â· {{englishTitle}}**
     * â›”ï¸ **ç»å¯¹ç¦æ­¢**ï¼šä¸¥ç¦å°†æ ‡é¢˜åˆ†ä¸ºä¸¤è¡Œæ˜¾ç¤ºï¼ä¸¥ç¦ä¸­æ–‡åœ¨ä¸Šè‹±æ–‡åœ¨ä¸‹ï¼å¿…é¡»å•è¡Œå±…ä¸­ã€‚

   ðŸŽ¨ æ–‡å­—é…è‰²ï¼ˆä¸¥æ ¼æ‰§è¡Œï¼‰ï¼š
     * ä¸­æ–‡éƒ¨åˆ† "{{title}}"ï¼šå¿…é¡»ä½¿ç”¨ **çº¯ç™½è‰² (#FFFFFF)**ã€‚
     * è‹±æ–‡éƒ¨åˆ† "{{englishTitle}}"ï¼šå¿…é¡»ä½¿ç”¨ **æµ…é‡‘è‰² (#FBBF24)**ã€‚
     * ç¡®ä¿æ‰€æœ‰æ–‡å­—åœ¨åŠé€æ˜ŽèƒŒæ™¯ä¸Šæ¸…æ™°å¯è¯»ï¼Œ**å¿…é¡»æ·»åŠ æ–‡å­—é˜´å½± (Drop Shadow)** ä»¥å¢žå¼ºå¯¹æ¯”åº¦ã€‚
   
   ðŸŒ«ï¸ å…³é”®ï¼šBannerä¸Žåœ°å›¾çš„äº¤ç•Œèžåˆ (FUSION):
   - **åº•éƒ¨è¾¹ç¼˜å¤„ç†**ï¼šä½¿ç”¨ **çª„å¹…é›¾åŒ–æ•ˆæžœ (Narrow Mist/Fog Fade)** ä¸Žä¸‹æ–¹çš„åœ°å›¾åŒºåŸŸè‡ªç„¶è¿žæŽ¥ã€‚
   - è§†è§‰æ•ˆæžœï¼šè®©æ ‡é¢˜æ çš„é£Žæ™¯èƒŒæ™¯åƒäº‘é›¾ä¸€æ ·è½»è½»æ¶ˆæ•£ï¼Œè‡ªç„¶è¿‡æ¸¡åˆ°ä¸‹æ–¹çš„åœ°å›¾æµ…ç°èƒŒæ™¯ä¸­ã€‚
   - â›”ï¸ **ç»å¯¹ç¦æ­¢**ï¼šä¸¥ç¦å‡ºçŽ°ç”Ÿç¡¬çš„ç›´çº¿åˆ†å‰²ã€æ˜Žæ˜¾çš„é»‘è‰²è¾¹æ¡†çº¿æˆ–ç”»é¢æ–­å±‚ã€‚åœ°å›¾åº”æ„Ÿè§‰åƒæ˜¯ä»Žæ ‡é¢˜æ ä¸‹æ–¹è‡ªç„¶å»¶ä¼¸å‡ºæ¥çš„ã€‚

2. åœ°å›¾åŒºåŸŸï¼ˆå å‰©ä½™é«˜åº¦ï¼‰ï¼š
   - å¸ƒå±€ï¼šåœ°å›¾ä»Žæ ‡é¢˜æ ä¸‹æ–¹è‡ªç„¶å»¶å±•ï¼Œå æ®å‰©ä½™åž‚ç›´ç©ºé—´ã€‚
   - é£Žæ ¼ï¼šçœŸå®žçš„ Google Maps é£Žæ ¼ï¼ˆæµ…ç°èƒŒæ™¯ï¼Œç™½è‰²é“è·¯ï¼Œç»¿è‰²å…¬å›­ï¼Œè“è‰²æ°´åŸŸï¼‰ã€‚
   
   âœ… åœ°å›¾æ–¹å‘ä¸ŽæŒ‡åŒ—é’ˆï¼š
   - å¿…é¡»æ­£åŒ—æœä¸Šï¼ˆæ ‡å‡†åœ°å›¾æ–¹å‘ï¼‰ã€‚
   - **æŒ‡åŒ—é’ˆä½ç½®**ï¼šå¿…é¡»åœ¨åœ°å›¾åŒºåŸŸçš„ **å·¦ä¸Šè§’ (Top-Left Corner)** æ¸…æ™°æ˜¾ç¤ºå°åž‹æŒ‡åŒ—é’ˆå›¾æ ‡æˆ–"Nâ†‘"æ ‡è¯†ã€‚
   - ä¸¥ç¦ï¼šæ–¹å‘æ··ä¹±ã€å—åŒ—é¢ å€’ã€‚

   æ ‡æ³¨ç³»ç»Ÿï¼š
   a) Pinæ ‡è®°ï¼ˆå…±3ä¸ªï¼‰ï¼š
      - ä½¿ç”¨çº¢è‰²æ°´æ»´å½¢Pinå›¾æ ‡ï¼Œæ ‡å·1, 2, 3ã€‚
      - Pinç²¾å‡†æ”¾ç½®åœ¨çœŸå®žåœ°ç†ä½ç½®ã€‚
      - Pinä¸‹æ–¹æ˜¾ç¤ºï¼šåœ°ç‚¹ä¸­è‹±æ–‡åç§° + ç»çº¬åº¦ã€‚

   b) è·¯å¾„çº¿ä¸Žè·ç¦»ï¼ˆä¸¥æ ¼é¡ºåºï¼‰ï¼š
      - ç»˜åˆ¶ **è“è‰²å¼¯æ›²è·¯å¾„çº¿ (Curved Blue Path Line)** æŒ‰é¡ºåºè¿žæŽ¥3ä¸ªPinã€‚
      - ðŸ›¤ï¸ **é£Žæ ¼**ï¼šæ¨¡æ‹ŸçœŸå®žçš„ GPS è½¨è¿¹ï¼Œ**ä¸æ˜¯ç®€å•çš„ç›´çº¿ (Not a simple straight line)**ã€‚
      - è¿žçº¿é¡ºåºï¼š
        1. Pin 1 âž¡ï¸ Pin 2
        2. Pin 2 âž¡ï¸ Pin 3
      - â›”ï¸ **ä¸¥ç¦**ï¼š**ç»å¯¹ä¸è¦**åœ¨ Pin 1 å’Œ Pin 3 ä¹‹é—´ç›´æŽ¥ç”»çº¿ã€‚
      - â›”ï¸ **ä¸¥ç¦**ï¼šè·¯å¾„å¿…é¡»æ˜¯å•å‘å¼€æ”¾çš„ï¼ˆOpen Pathï¼‰ï¼Œ**ç»å¯¹ä¸å¯å½¢æˆé—­çŽ¯**ã€‚
      - è·¯å¾„ä¸Šæ ‡æ³¨è·ç¦»ï¼ˆå¦‚"180 km"ï¼‰ï¼Œéœ€æ ¹æ®çœŸå®žåœ°ç†è·ç¦»è®¡ç®—ã€‚

3. ç…§ç‰‡å åŠ å±‚ï¼ˆå…³é”®å¸ƒå±€è¦æ±‚ï¼‰ï¼š
   - æ ¼å¼ï¼š**3å¼ ç…§ç‰‡å¿…é¡»å‡ä¸º 9:16 ç«–ç‰ˆæ ¼å¼ï¼Œå°ºå¯¸å®Œå…¨ä¸€è‡´**ã€‚
   - å†…å®¹ (ä¸¥æ ¼èƒŒæ™¯å¯¹åº”):
     * ä¸¥æ ¼åº”ç”¨"äººç‰©ä¿çœŸæŠ€æœ¯"ï¼Œä¿æŒå‚è€ƒå›¾äººç‰©çš„ç‰¹å¾å’Œå§¿æ€ã€‚
     * ðŸ“ **ç…§ç‰‡ 1 èƒŒæ™¯**ï¼šå¿…é¡»æ˜¯ **{{loc1_name}}** çš„æ ‡å¿—æ€§åœ°æ ‡æˆ–è‡ªç„¶é£Žæ™¯ã€‚
     * ðŸ“ **ç…§ç‰‡ 2 èƒŒæ™¯**ï¼šå¿…é¡»æ˜¯ **{{loc2_name}}** çš„æ ‡å¿—æ€§åœ°æ ‡æˆ–è‡ªç„¶é£Žæ™¯ã€‚
     * ðŸ“ **ç…§ç‰‡ 3 èƒŒæ™¯**ï¼šå¿…é¡»æ˜¯ **{{loc3_name}}** çš„æ ‡å¿—æ€§åœ°æ ‡æˆ–è‡ªç„¶é£Žæ™¯ã€‚
   
   ðŸ“Œ ä½ç½®é”šå®š (STRADDLING THE JUNCTION):
   - **åž‚ç›´ä½ç½®**ï¼š3å¼ ç…§ç‰‡å¿…é¡»æ”¾ç½®åœ¨ **æ ‡é¢˜æ ä¸Žåœ°å›¾åŒºåŸŸçš„äº¤ç•Œçº¿ä¸Š**ã€‚
   - **é‡å¿ƒæŽ§åˆ¶**ï¼š
     * ç…§ç‰‡é¡¶éƒ¨çº¦ **20%** çš„åŒºåŸŸè¦†ç›–åœ¨æ ‡é¢˜æ ï¼ˆBannerï¼‰çš„åº•éƒ¨é›¾åŒ–è¾¹ç¼˜ä¸Šã€‚
     * ç…§ç‰‡åº•éƒ¨çº¦ **80%** çš„åŒºåŸŸ **ä¸»è¦åŽ‹åœ¨åœ°å›¾åŒºåŸŸä¸Š**ã€‚
     * è§†è§‰ä¸Šï¼Œç…§ç‰‡èµ·åˆ°äº†è¿žæŽ¥æ ‡é¢˜æ å’Œåœ°å›¾çš„"é’‰å­"æˆ–"æ¡¥æ¢"ä½œç”¨ã€‚
   
   ðŸŽ¨ è‰ºæœ¯æŽ’åˆ— (ARTISTIC ARRANGEMENT - STRICT):
   - **å¸ƒå±€æ¨¡å¼**ï¼šæ¨ªå‘æŽ’åˆ— + åŠ¨æ€æž„å›¾ (Dynamic Composition)ã€‚
   - **é‡å æŽ§åˆ¶**ï¼šç›¸é‚»ç…§ç‰‡ä¹‹é—´å¿…é¡»æœ‰ **10-15% çš„æ°´å¹³é‡å ** (Overlap)ã€‚
   - **å±‚çº§å…³ç³» (Z-Index)**ï¼š
     * **ç…§ç‰‡ 2 (ä¸­é—´)**ï¼šä½äºŽæœ€é¡¶å±‚ (Front)ï¼Œç¨å¾®é®æŒ¡å·¦å³ä¸¤å¼ ç…§ç‰‡çš„å†…ä¾§è¾¹ç¼˜ã€‚
     * **ç…§ç‰‡ 1 å’Œ ç…§ç‰‡ 3**ï¼šä½äºŽè¾ƒåº•å±‚ (Back)ã€‚

   ðŸ“ å€¾æ–œè§’åº¦ (PRECISE TILT ANGLES - VISUAL ONLY):
   - **ç…§ç‰‡ 1 (å·¦)**ï¼š**å‘å·¦å€¾æ–œ -5Â°** (Tilt -5 degrees)ã€‚
   - **ç…§ç‰‡ 2 (ä¸­)**ï¼š**ç•¥å¾®å‘å³å€¾æ–œ +3Â°** (Tilt +3 degrees)ï¼Œä¸”**åž‚ç›´ä½ç½®ç•¥é«˜äºŽ**å·¦å³ä¸¤å¼ ç…§ç‰‡ (Slightly Higher)ã€‚
   - **ç…§ç‰‡ 3 (å³)**ï¼š**å‘å³å€¾æ–œ +6Â°** (Tilt +6 degrees)ã€‚
   
   â›”ï¸ **ä¸¥ç¦ (FORBIDDEN)**ï¼š
   - ðŸš¨ **ä¸¥ç¦å°†å€¾æ–œåº¦æ•°æ–‡å­—å†™åœ¨ç”»é¢ä¸Š** (DO NOT WRITE TEXT LIKE "-5Â°", "+3Â°"). å€¾æ–œæ˜¯è§†è§‰æ•ˆæžœï¼Œä¸æ˜¯æ–‡å­—å†…å®¹ï¼
   - ä¸¥ç¦å®Œå…¨å¹³è¡ŒæŽ’åˆ— (No Parallel)ã€‚
   - ä¸¥ç¦æ— å€¾æ–œ (No Zero Tilt)ã€‚
   - ä¸¥ç¦æ— é‡å  (No Zero Overlap)ã€‚
   - **ä¸¥ç¦ä½¿ç”¨æ‹ç«‹å¾—è¾¹æ¡† (NO POLAROID BORDERS)**ï¼šç…§ç‰‡å¿…é¡»æ˜¯æ— è¾¹æ¡†çš„çº¯ç”»é¢ï¼Œè¾¹ç¼˜æ¸…æ™°é”åˆ©ã€‚

   âœï¸ ç…§ç‰‡ä¸‹æ–¹æ ‡æ³¨ (HANDWRITTEN LABELS):
   - å†…å®¹ï¼šæ¯å¼ ç…§ç‰‡æ­£ä¸‹æ–¹æ ‡æ³¨ "åœ°ç‚¹åç§° æ—¥æœŸ" (ä¾‹å¦‚: "{{loc1_name}} {{loc1_date}}").
   - å­—ä½“é£Žæ ¼ï¼š**å¿…é¡»ä½¿ç”¨æ‰‹å†™å­—ä½“ (Handwritten Style)**.
   - æŽ¨èå­—ä½“å‚è€ƒï¼š**Amatic SC** æˆ– **Shadows Into Light**.
   - é¢œè‰²ï¼šç™½è‰²æˆ–æµ…ç°è‰²ï¼Œæ¸…æ™°å¯è¯»ã€‚

4. åœ°å›¾ç¼©ç•¥å›¾ (CRITICAL FIX: VISIBILITY & CONTENT):
   - ðŸš¨ **æ ¸å¿ƒä¿®å¤æŒ‡ä»¤ (MANDATORY)**: åœ°å›¾ä¸Šçš„3ä¸ªç¼©ç•¥å›¾ **å¿…é¡»åŒ…å«çœŸå®žçš„å›¾åƒç»†èŠ‚ (MUST HAVE REAL IMAGE CONTENT)**ã€‚
     * âŒ **ç»å¯¹ä¸¥ç¦ (STRICTLY FORBIDDEN)**ï¼šç”Ÿæˆç©ºç™½ã€ç°è‰²ã€é»‘è‰²ã€é€æ˜Žæˆ–ä»…ä»…æ˜¯è¾¹æ¡†çš„ç©ºæ–¹å—ã€‚
     * âŒ **ç»å¯¹ä¸¥ç¦**ï¼šä½¿ç”¨æ¨¡ç³Šçš„å ä½ç¬¦ã€‚
     * âœ… **å¿…é¡»æ‰§è¡Œ**ï¼šç¼©ç•¥å›¾å¿…é¡»æ˜¯å½©è‰²çš„ã€æ¸…æ™°çš„ã€å†…å®¹å¯è¾¨çš„å¾®åž‹ç…§ç‰‡ã€‚æƒ³è±¡ä½ æŠŠä¸Šé¢çš„å¤§ç…§ç‰‡ç¼©å°å¹¶ç²˜è´´åˆ°äº†åœ°å›¾ä¸Šã€‚
   
   - ðŸ” **å†…å®¹å…‹éš† (Pixel-Level Replication)**: 
     * Pin 1 æ—è¾¹çš„ç¼©ç•¥å›¾ âž¡ï¸ å¿…é¡»å±•ç¤º **[ç…§ç‰‡ 1]** ({{loc1_name}}) çš„å®Œæ•´ç”»é¢ã€‚
     * Pin 2 æ—è¾¹çš„ç¼©ç•¥å›¾ âž¡ï¸ å¿…é¡»å±•ç¤º **[ç…§ç‰‡ 2]** ({{loc2_name}}) çš„å®Œæ•´ç”»é¢ã€‚
     * Pin 3 æ—è¾¹çš„ç¼©ç•¥å›¾ âž¡ï¸ å¿…é¡»å±•ç¤º **[ç…§ç‰‡ 3]** ({{loc3_name}}) çš„å®Œæ•´ç”»é¢ã€‚

   - æ ·å¼ï¼šæžå°ã€æ— è¾¹æ¡†ã€ç´§æŒ¨ç€å¯¹åº”çš„Pinã€‚

5. åº•éƒ¨ä¿¡æ¯æ ï¼š
   - å åŠ åœ¨åœ°å›¾åº•éƒ¨ï¼Œè´¯ç©¿æ•´ä¸ªå®½åº¦ã€‚
   - **èƒŒæ™¯æ ·å¼**ï¼š**æ·±è‰²åŠé€æ˜ŽçŠ¶æ€æ  (Dark Semi-Transparent Status Bar)**ï¼Œé¢œè‰²çº¦ä¸º rgba(15, 23, 42, 0.85)ï¼Œç¡®ä¿æ–‡å­—æ¸…æ™°å¯è¯»ã€‚
   - æ–‡å­—æ ¼å¼ (ä¸¥æ ¼æ‰§è¡Œ): "â˜€ï¸ æ™´ 22Â°C | æµ·æ‹”: {MinAlt}m-{MaxAlt}m â›°ï¸ | æ€»è·ç¦»: {TotalDist} km"
   - æ•°æ®è®¡ç®—è¦æ±‚:
     * **æµ·æ‹”èŒƒå›´**: æ ¹æ®3ä¸ªåœ°ç‚¹çš„çœŸå®žæµ·æ‹”æ•°æ®ï¼Œè®¡ç®—å¹¶æ˜¾ç¤ºæœ€ä½Žç‚¹å’Œæœ€é«˜ç‚¹ï¼ˆæ ¼å¼ç¤ºä¾‹ï¼š1608m-3089mï¼‰ã€‚
     * **æ€»è·ç¦»**: è®¡ç®—3ä¸ªåœ°ç‚¹é—´çš„çœŸå®žæ€»è·¯å¾„è·ç¦»ã€‚
     * ðŸš¨ **ä¸¥ç¦ä½¿ç”¨æ³¢æµªå·** (No Tilde): æ€»è·ç¦»å¿…é¡»æ˜¾ç¤ºä¸ºç¡®åˆ‡çš„æ•°å­—ï¼ˆä¾‹å¦‚ï¼š400ï¼‰ï¼Œ**ä¸¥ç¦**å‡ºçŽ° "~"ã€"çº¦" æˆ– "approx" ç­‰æ¨¡ç³Šç¬¦å·ã€‚
   - æ ·å¼ï¼šé‡‘è‰²/ç™½è‰²æ–‡å­—ã€‚

è¾“å‡ºè§„æ ¼ï¼š
- 9:16 ç«–ç‰ˆï¼Œé«˜åˆ†è¾¨çŽ‡ï¼Œæ‘„å½±å†™å®žé£Žæ ¼ã€‚
`;

// Maintained for backwards compatibility if needed, but now uses the template system
export const buildPrompt = (data: PosterFormData, customTemplate?: string): string => {
  const context = getPromptContext(data);
  const template = customTemplate || DEFAULT_PROMPT_TEMPLATE;
  return fillPromptTemplate(template, context);
};
